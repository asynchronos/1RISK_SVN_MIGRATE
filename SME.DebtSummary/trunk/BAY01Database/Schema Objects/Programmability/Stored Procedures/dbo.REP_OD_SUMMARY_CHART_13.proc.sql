







-- =============================================
-- Author:		Prakit Sirisaksathaporn
-- Create date: 10 Oct 2008
-- Description:	REP_OD_SUMMARY_CHART
-- =============================================
CREATE PROCEDURE [dbo].[REP_OD_SUMMARY_CHART_13]
	-- Add the parameters for the stored procedure here
	@ACCNO NVARCHAR(18)
AS
BEGIN
	-- SET NOCOUNT ON added to prevent extra result sets from
	-- interfering with SELECT statements.
	SET NOCOUNT ON;

	SELECT 'DEBIT' AS 'SUMMARY'
		, MVMDAM12/1000 AS MVMDAM12, MVMDAM11/1000 AS MVMDAM11
		, MVMDAM10/1000 AS MVMDAM10, MVMDAM09/1000 AS MVMDAM09
		, MVMDAM08/1000 AS MVMDAM08, MVMDAM07/1000 AS MVMDAM07
		, MVMDAM06/1000 AS MVMDAM06, MVMDAM05/1000 AS MVMDAM05
		, MVMDAM04/1000 AS MVMDAM04, MVMDAM03/1000 AS MVMDAM03
		, MVMDAM02/1000 AS MVMDAM02, MVMDAM01/1000 AS MVMDAM01
		, MVMDR_AVG/1000 AS MVMDR_AVG, run_date
	FROM REP_OD13 
	WHERE (ACCNO = @ACCNO) 

	UNION ALL

	SELECT 'CREDIT' AS 'SUMMARY'
		, MVMCAM12/1000, MVMCAM11/1000, MVMCAM10/1000
		, MVMCAM09/1000, MVMCAM08/1000, MVMCAM07/1000
		, MVMCAM06/1000, MVMCAM05/1000, MVMCAM04/1000
		, MVMCAM03/1000, MVMCAM02/1000, MVMCAM01/1000
		, MVMCR_AVG/1000, run_date
	FROM REP_OD13 AS REP_OD_1 
	WHERE (ACCNO = @ACCNO) 

	UNION ALL

	SELECT 'LIMIT' AS 'SUMMARY'
		, LIMIT12/1000, LIMIT11/1000, LIMIT10/1000
		, LIMIT09/1000, LIMIT08/1000, LIMIT07/1000
		, LIMIT06/1000, LIMIT05/1000, LIMIT04/1000
		, LIMIT03/1000, LIMIT02/1000, LIMIT01/1000
		, LIM_AVG/1000
		, run_date
	FROM REP_OD13 AS REP_OD_2 
	WHERE (ACCNO = @ACCNO) 

	UNION ALL 

	SELECT 'UTILIZATION' AS 'SUMMARY'
		, UTINEG12/1000, UTINEG11/1000, UTINEG10/1000
		, UTINEG09/1000, UTINEG08/1000, UTINEG07/1000
		, UTINEG06/1000, UTINEG05/1000, UTINEG04/1000
		, UTINEG03/1000, UTINEG02/1000, UTINEG01/1000
		, UTILIZ_AVG/1000, run_date
	FROM REP_OD13 AS REP_OD_3 
	WHERE (ACCNO = @ACCNO) 

	UNION ALL 

	SELECT '%UTILIZATION' AS 'SUMMARY'
		, CASE WHEN LIMIT12=0 THEN 0 ELSE UTINEG12 * 100 / LIMIT12 END
		, CASE WHEN LIMIT11=0 THEN 0 ELSE UTINEG11 * 100 / LIMIT11 END
		, CASE WHEN LIMIT10=0 THEN 0 ELSE UTINEG10 * 100 / LIMIT10 END
		, CASE WHEN LIMIT09=0 THEN 0 ELSE UTINEG09 * 100 / LIMIT09 END
		, CASE WHEN LIMIT08=0 THEN 0 ELSE UTINEG08 * 100 / LIMIT08 END
		, CASE WHEN LIMIT07=0 THEN 0 ELSE UTINEG07 * 100 / LIMIT07 END
		, CASE WHEN LIMIT06=0 THEN 0 ELSE UTINEG06 * 100 / LIMIT06 END
		, CASE WHEN LIMIT05=0 THEN 0 ELSE UTINEG05 * 100 / LIMIT05 END
		, CASE WHEN LIMIT04=0 THEN 0 ELSE UTINEG04 * 100 / LIMIT04 END
		, CASE WHEN LIMIT03=0 THEN 0 ELSE UTINEG03 * 100 / LIMIT03 END
		, CASE WHEN LIMIT02=0 THEN 0 ELSE UTINEG02 * 100 / LIMIT02 END
		, CASE WHEN LIMIT01=0 THEN 0 ELSE UTINEG01 * 100 / LIMIT01 END
		, CASE WHEN LIM_AVG=0 THEN 0 ELSE (UTILIZ_AVG*100)/(LIM_AVG) END
		, run_date
	FROM REP_OD13 AS REP_OD_3 
	WHERE (ACCNO = @ACCNO) 

	UNION ALL 

	SELECT 'MAX_BALANCE' AS 'SUMMARY'
		, MAXBAL12/1000, MAXBAL11/1000, MAXBAL10/1000
		, MAXBAL09/1000, MAXBAL08/1000, MAXBAL07/1000
		, MAXBAL06/1000, MAXBAL05/1000, MAXBAL04/1000
		, MAXBAL03/1000, MAXBAL02/1000, MAXBAL01/1000
		, MAXBALAVG/1000, run_date
	FROM REP_OD13 AS REP_OD_4 
	WHERE (ACCNO = @ACCNO) 

	UNION ALL 

	SELECT 'MIN_BALANCE' AS 'SUMMARY'
		, MINBAL12/1000, MINBAL11/1000, MINBAL10/1000
		, MINBAL09/1000, MINBAL08/1000, MINBAL07/1000
		, MINBAL06/1000, MINBAL05/1000, MINBAL04/1000
		, MINBAL03/1000, MINBAL02/1000, MINBAL01/1000
		, MINBALAVG/1000, run_date
	FROM REP_OD13 AS REP_OD_5 
	WHERE (ACCNO = @ACCNO)
END








